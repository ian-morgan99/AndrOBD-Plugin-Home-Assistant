apply plugin: 'com.android.application'

android {
    compileSdk 34
    defaultConfig {
        applicationId 'com.fr3ts0n.androbd.plugin.homeassistant'
        minSdkVersion 15
        targetSdkVersion 33
        vectorDrawables.useSupportLibrary = true
        versionCode 10000
        versionName 'V1.0.0'
    }

    applicationVariants.configureEach { variant ->
        // Generate version name resource value for use in the app
        // Note: This may generate a Gradle warning about task outputs, which is expected
        // and does not affect the build
        variant.resValue "string", "app_version", variant.versionName
    }

    signingConfigs {
        release {
            // Use a consistent release keystore to prevent package conflicts during updates
            // This keystore is included in the repository for consistent signing across builds
            // Password 'android' is intentionally simple for this open-source project
            // See SIGNING.md for security considerations and why this is acceptable
            storeFile rootProject.file('release-keystore.jks')
            storePassword 'android'
            keyAlias 'androbd-ha-plugin'
            keyPassword 'android'
        }
    }

    buildTypes {
        debug {
            // Use the same signing config as release to prevent package conflicts
            // This ensures users can switch between debug and release builds without uninstalling
            signingConfig signingConfigs.release
        }
        release {
            // Use consistent release signing to prevent package conflicts when updating
            signingConfig signingConfigs.release
            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.txt'
        }
    }

    productFlavors {
    }
    namespace 'com.fr3ts0n.androbd.plugin.homeassistant'
    lint {
        abortOnError false
    }
}

dependencies {
    implementation project(':plugin')
    implementation 'com.squareup.okhttp3:okhttp:4.12.0'
    implementation 'androidx.annotation:annotation:1.7.1'
    implementation 'androidx.core:core:1.12.0'
}
